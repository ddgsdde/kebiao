<div class="bg-white rounded-lg p-6 shadow-md">
  <h2 class="text-xl font-bold text-slate-800 mb-4">
    <i class="fa-solid fa-users-cog mr-2"></i>账户管理
  </h2>

  <!-- Bulk Registration -->
  <div class="mb-6">
    <h3 class="text-lg font-semibold text-slate-700 mb-2">批量注册</h3>
    <p class="text-sm text-slate-500 mb-3">每行输入一个用户，格式为：<code class="bg-slate-100 text-slate-800 px-1 py-0.5 rounded text-xs">用户名,密码</code>。</p>
    <textarea 
      rows="5"
      class="w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 text-sm font-mono" 
      placeholder="例如:&#10;user1,password123&#10;user2,anotherpassword"
      [value]="bulkRegisterContent()"
      (input)="bulkRegisterContent.set($any($event.target).value)"></textarea>
    <button
      (click)="handleBulkRegister()"
      [disabled]="!bulkRegisterContent().trim()"
      class="mt-3 w-full bg-teal-600 text-white font-bold py-2 px-4 rounded-md hover:bg-teal-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors shadow-sm">
      注册用户
    </button>
  </div>

  <!-- User List -->
  <div>
    <h3 class="text-lg font-semibold text-slate-700 mb-3 border-t border-slate-200 pt-4">用户列表</h3>
    @if (users().length > 0) {
      <ul class="space-y-2 max-h-72 overflow-y-auto pr-2">
        @for (user of users(); track user.username) {
          <li class="flex items-center justify-between p-2 rounded-md hover:bg-slate-50 group">
            <div class="flex items-center">
              <span class="text-sm font-medium text-slate-800">{{ user.username }}</span>
              @if (user.role === 'admin') {
                <span class="ml-2 text-xs bg-teal-100 text-teal-700 font-semibold px-2 py-0.5 rounded-full">管理员</span>
              }
            </div>
            <div class="flex items-center gap-3 opacity-0 group-hover:opacity-100 transition-opacity">
               <button 
                  (click)="resetPassword(user.username)"
                  title="重置密码"
                  class="text-slate-400 hover:text-sky-500">
                  <i class="fas fa-key fa-sm"></i>
              </button>
              <button
                (click)="deleteUser(user.username)"
                [disabled]="user.username === 'admin'"
                title="删除用户"
                class="text-slate-400 hover:text-red-500 disabled:opacity-25 disabled:hover:text-slate-400 disabled:cursor-not-allowed">
                <i class="fas fa-trash-alt fa-sm"></i>
              </button>
            </div>
          </li>
        }
      </ul>
    } @else {
      <p class="text-sm text-slate-500">没有找到其他用户。</p>
    }
  </div>

  <!-- Status Message -->
  @if(statusMessage(); as msg) {
    <div 
      class="mt-4 p-3 rounded-md text-sm"
      [class]="msg.type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'">
      <i [class]="msg.type === 'success' ? 'fa fa-check-circle' : 'fa fa-exclamation-triangle'" class="mr-2"></i>
      {{ msg.text }}
    </div>
  }
</div>
